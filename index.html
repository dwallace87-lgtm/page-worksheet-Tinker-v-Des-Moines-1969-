<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>P.A.G.E. Strategy Worksheet (Tinker v. Des Moines)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Tinos:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
  <style>
    :root { --ring: #111827; }
    body { font-family: 'Inter', sans-serif; }
    .worksheet-container { max-width: 1200px; }
    .source-text { font-family: 'Tinos', serif; }
    .strategy-box { border-radius: 0.5rem; padding: 1.25rem; display:flex; flex-direction:column; height:100%; border-width:2px; }
    .strategy-box p, .strategy-box ul, .strategy-box label { font-size: 1.05rem; line-height: 1.5rem; }
    .strategy-header { display:flex; align-items:center; margin-bottom:0.5rem; }
    .letter { flex-shrink:0; display:flex; align-items:center; justify-content:center; width:2.5rem; height:2.5rem; color:white; font-weight:700; font-size:1.25rem; border-radius:9999px; margin-right:0.6rem; }
    .title { font-size:1.35rem; font-weight:600; }
    .writing-space { border:1px dashed #9ca3af; background:white; border-radius:0.375rem; min-height:120px; padding:0.65rem; width:100%; flex-grow:1; }
    .cuba-list li { margin-bottom:0.25rem; }
    /* Color themes */
    .p-box{ border-color:#93c5fd } .p-box .letter{ background:#3b82f6 } .p-box .title{ color:#1e40af }
    .a-box{ border-color:#fca5a5 } .a-box .letter{ background:#ef4444 } .a-box .title{ color:#991b1b }
    .g-box{ border-color:#fcd34d } .g-box .letter{ background:#f59e0b } .g-box .title{ color:#92400e }
    .e-box{ border-color:#c4b5fd } .e-box .letter{ background:#8b5cf6 } .e-box .title{ color:#5b21b6 }

    /* High-contrast (print-friendly) toggle */
    .hc .a-box, .hc .p-box, .hc .g-box, .hc .e-box { background:#fff !important; }
    .hc .letter { background:#111827 !important; }
    .hc .title { color:#111827 !important; }
    .hc .border-gray-300 { border-color:#111827 !important; }

    /* Answer options formatting */
    .choice { display:flex; align-items:flex-start; gap:0.5rem; }
    .choice span { font-weight:600; }

    /* Print styles */
    @page { size: Letter; margin: 0.5in; }
    @media print {
      .no-print { display:none !important; }
      body { background:white; }
      .worksheet-container { max-width: 100%; }
    }
  </style>
</head>
<body class="bg-white text-gray-900">
  <div class="worksheet-container mx-auto p-4 lg:p-6">
    <!-- Header -->
    <header class="pb-4 mb-4 border-b-2 border-gray-200">
      <div class="flex items-center justify-between flex-wrap gap-3">
        <h1 class="text-3xl md:text-4xl font-bold">Modeling the P.A.G.E. Strategy</h1>
        <div class="no-print flex items-center gap-2">
          <button id="contrastBtn" class="px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50" title="Toggle high-contrast mode">High contrast</button>
          <button onclick="window.print()" class="px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50" title="Print this worksheet">Print</button>
          <button id="resetBtn" class="px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50" title="Clear all entries">Reset</button>
        </div>
      </div>
      <p class="text-sm text-gray-600 mt-2">Case focus: <span class="font-semibold">Tinker v. Des Moines (1969)</span></p>
    </header>

    <!-- Roster Submit Form (sends to Google Sheets via Apps Script) -->
    <form id="rosterForm" class="grid grid-cols-1 sm:grid-cols-4 gap-3 bg-gray-50 p-4 rounded-lg border border-gray-200 mb-6">
      <label class="text-sm">Period
        <select id="period" class="mt-1 w-full rounded-md border border-gray-300 px-2 py-1" required>
          <option value="" selected disabled>Select</option>
          <option>1</option><option>2</option><option>3</option><option>4</option>
          <option>5</option><option>6</option><option>7</option>
        </select>
      </label>
      <label class="text-sm">First name
        <input id="firstName" type="text" class="mt-1 w-full rounded-md border border-gray-300 px-2 py-1" required />
      </label>
      <label class="text-sm">Last name
        <input id="lastName" type="text" class="mt-1 w-full rounded-md border border-gray-300 px-2 py-1" required />
      </label>
      <div class="flex items-end">
        <button type="submit" class="w-full sm:w-auto px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-100">Submit</button>
      </div>
      <p id="formMsg" class="sm:col-span-4 text-sm mt-1"></p>
    </form>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Left Column -->
      <div class="flex flex-col gap-6">
        <!-- A - Ask -->
        <section class="strategy-box a-box bg-red-100">
          <div class="strategy-header">
            <span class="letter">A</span>
            <h3 class="title">Ask</h3>
          </div>
          <p class="mb-2">Use <b class="font-semibold">C.U.B.</b> to break down the question, then rewrite it in your own words.</p>
          <ul class="cuba-list list-disc list-inside bg-white p-3 rounded-md mb-3">
            <li><b class="font-semibold">C</b> – Circle key words and phrases.</li>
            <li><b class="font-semibold">U</b> – Underline the main task.</li>
            <li><b class="font-semibold">B</b> – Box any action words.</li>
          </ul>
          <p class="font-semibold mb-2 mt-2">In my own words, the question is asking:</p>
          <div class="writing-space" contenteditable="true" data-field="ask-paraphrase" aria-label="Ask: paraphrase the question"></div>
        </section>
        <!-- G - Gist -->
        <section class="strategy-box g-box bg-amber-100">
          <div class="strategy-header">
            <span class="letter">G</span>
            <h3 class="title">Gist</h3>
          </div>
          <p class="mb-2">In one sentence, what is the main idea of the source text?</p>
          <div class="writing-space" contenteditable="true" data-field="gist" aria-label="Gist: main idea"></div>
        </section>
      </div>

      <!-- Center Column -->
      <section class="rounded-lg p-6 flex flex-col justify-center border-2 border-gray-300 bg-white lg:sticky lg:top-4">
        <div class="mb-6">
          <h2 class="font-bold text-gray-800 mb-2">Source (Summary of a Supreme Court Decision)</h2>
          <p class="source-text text-lg leading-relaxed">
            In the 1969 case of <b class="font-semibold">Tinker v. Des Moines</b>, the Supreme Court made a <b class="font-semibold">landmark decision about student rights</b>. A group of high school students <b class="font-semibold">wore black armbands</b> to school to protest the Vietnam War. The school district, <b class="font-semibold">fearing a disruption, suspended the students</b>. The students' families sued. The Supreme Court <b class="font-semibold">ruled in favor of the students</b>, stating that students do not <b class="font-semibold">"shed their constitutional rights to freedom of speech or expression at the schoolhouse gate."</b> The Court clarified that student expression is protected by the <b class="font-semibold">First Amendment</b> as long as it does <b class="font-semibold">not substantially disrupt the educational environment or invade the rights of others</b>.
          </p>
        </div>
        <div>
          <p class="source-text text-lg leading-relaxed mb-4">
            <b class="font-bold">Question 1.</b> A student wears a t‑shirt with a rainbow pride flag. Based on the precedent in <em>Tinker v. Des Moines</em>, which action would be most consistent with the ruling?
          </p>
          <div class="source-text text-lg leading-relaxed space-y-2 ml-1">
            <label class="choice"><input type="radio" name="q1" value="1" class="mt-1"> <span>(1)</span> The school suspends the student for expressing a political opinion.</label>
            <label class="choice"><input type="radio" name="q1" value="2" class="mt-1"> <span>(2)</span> The school allows the student to wear the shirt because it is unlikely to cause a major disruption.</label>
            <label class="choice"><input type="radio" name="q1" value="3" class="mt-1"> <span>(3)</span> The school asks the student to remove the shirt because another student disagrees with the message.</label>
            <label class="choice"><input type="radio" name="q1" value="4" class="mt-1"> <span>(4)</span> The school bans all clothing with symbols to prevent future problems.</label>
          </div>
        </div>
      </section>

      <!-- Right Column -->
      <div class="flex flex-col gap-6">
        <!-- P - Prior Knowledge -->
        <section class="strategy-box p-box bg-blue-100">
          <div class="strategy-header">
            <span class="letter">P</span>
            <h3 class="title">Prior Knowledge</h3>
          </div>
          <p class="mb-2">What do you already know about the First Amendment or student rights?</p>
          <div class="writing-space" contenteditable="true" data-field="prior" aria-label="Prior knowledge"></div>
        </section>
        <!-- E - Eliminate -->
        <section class="strategy-box e-box bg-purple-100">
          <div class="strategy-header">
            <span class="letter">E</span>
            <h3 class="title">Eliminate</h3>
          </div>
          <p class="mb-2">Is each choice right or wrong? Why?</p>
          <div class="flex flex-col gap-3">
            <!-- 1 -->
            <div>
              <div class="flex items-center gap-4 mb-1">
                <b class="text-lg">(1)</b>
                <label class="flex items-center cursor-pointer"><input type="radio" name="eval1" value="Right" class="mr-2 h-4 w-4">Right</label>
                <label class="flex items-center cursor-pointer"><input type="radio" name="eval1" value="Wrong" class="mr-2 h-4 w-4">Wrong</label>
              </div>
              <div class="w-full bg-white border-b-2 border-dashed border-gray-400 min-h-[3rem] writing-space" contenteditable="true" data-field="eval1"></div>
            </div>
            <!-- 2 -->
            <div>
              <div class="flex items-center gap-4 mb-1">
                <b class="text-lg">(2)</b>
                <label class="flex items-center cursor-pointer"><input type="radio" name="eval2" value="Right" class="mr-2 h-4 w-4">Right</label>
                <label class="flex items-center cursor-pointer"><input type="radio" name="eval2" value="Wrong" class="mr-2 h-4 w-4">Wrong</label>
              </div>
              <div class="w-full bg-white border-b-2 border-dashed border-gray-400 min-h-[3rem] writing-space" contenteditable="true" data-field="eval2"></div>
            </div>
            <!-- 3 -->
            <div>
              <div class="flex items-center gap-4 mb-1">
                <b class="text-lg">(3)</b>
                <label class="flex items-center cursor-pointer"><input type="radio" name="eval3" value="Right" class="mr-2 h-4 w-4">Right</label>
                <label class="flex items-center cursor-pointer"><input type="radio" name="eval3" value="Wrong" class="mr-2 h-4 w-4">Wrong</label>
              </div>
              <div class="w-full bg-white border-b-2 border-dashed border-gray-400 min-h-[3rem] writing-space" contenteditable="true" data-field="eval3"></div>
            </div>
            <!-- 4 -->
            <div>
              <div class="flex items-center gap-4 mb-1">
                <b class="text-lg">(4)</b>
                <label class="flex items-center cursor-pointer"><input type="radio" name="eval4" value="Right" class="mr-2 h-4 w-4">Right</label>
                <label class="flex items-center cursor-pointer"><input type="radio" name="eval4" value="Wrong" class="mr-2 h-4 w-4">Wrong</label>
              </div>
              <div class="w-full bg-white border-b-2 border-dashed border-gray-400 min-h-[3rem] writing-space" contenteditable="true" data-field="eval4"></div>
            </div>
          </div>
        </section>
      </div>
    </div>
    </div>

    <!-- Footer hint (teacher note) -->
    <footer class="mt-6 text-sm text-gray-600">
      <p><span class="font-semibold">Tip:</span> If an answer would cause a <em>substantial disruption</em> or invade others’ rights, it is not protected per <em>Tinker</em>.</p>
    </footer>
  </div>

  <script>
    // Local save of contenteditable fields
    const FIELDS = document.querySelectorAll('[contenteditable][data-field]');
    const RADIOS = document.querySelectorAll('input[type="radio"]');

    // Load saved text
    FIELDS.forEach(el => {
      const key = 'pagews_' + el.dataset.field;
      const saved = localStorage.getItem(key);
      if (saved !== null) el.innerHTML = saved;
      el.addEventListener('input', () => localStorage.setItem(key, el.innerHTML));
    });

    // Load saved radios
    RADIOS.forEach((r, i) => {
      const key = 'pagews_radio_' + i;
      const saved = localStorage.getItem(key);
      if (saved === '1') r.checked = true;
      r.addEventListener('change', () => {
        // Save all radios on any change
        RADIOS.forEach((rb, j) => localStorage.setItem('pagews_radio_' + j, rb.checked ? '1' : '0'));
      });
    });

    // Reset button
    document.getElementById('resetBtn')?.addEventListener('click', () => {
      if (!confirm('Clear all entries on this worksheet?')) return;
      FIELDS.forEach(el => { el.innerHTML = ''; localStorage.removeItem('pagews_' + el.dataset.field); });
      RADIOS.forEach((r, i) => { r.checked = false; localStorage.removeItem('pagews_radio_' + i); });
      // Clear inputs
      document.querySelectorAll('input[type="text"]').forEach(i => i.value = '');
    });

    // High contrast toggle
    document.getElementById('contrastBtn')?.addEventListener('click', () => {
      document.body.classList.toggle('hc');
    });
      
    // ===== Apps Script submission (POST to your Sheet web app) =====
    // Replace the URL below with your deployed Apps Script Web App URL
     // Your live Apps Script Web App URL:
  const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyUsUnkv9_ZpuxUmeEUCAhHSSuVuMJhmI821Hrea_3MgCcnQh5ZF1x4XHPuywZG4dJCSA/exec';
  const PAGE_VERSION = 'v5'; // cache-buster

  // Helpers
  const getVal = (name) =>
    (document.querySelector(`input[name="${name}"]:checked`)?.value || '');
  const getTxt = (field) => {
    const el = document.querySelector(`[data-field="${field}"]`);
    return el ? el.textContent.replace(/\s+/g, ' ').trim() : '';
  };

  // Wait for DOM so #rosterForm definitely exists
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('rosterForm');
    const msg  = document.getElementById('formMsg');

    if (!form) {
      console.error('Roster form not found.');
      if (msg) msg.textContent = 'Error: form not found.';
      return;
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      if (msg) msg.textContent = 'Submitting…';

      const payload = {
        period: document.getElementById('period')?.value || '',
        firstName: document.getElementById('firstName')?.value.trim() || '',
        lastName: document.getElementById('lastName')?.value.trim() || '',
        q1Choice: getVal('q1'),
        askParaphrase: getTxt('ask-paraphrase'),
        gist: getTxt('gist'),
        prior: getTxt('prior'),
        eval1Choice: getVal('eval1'), eval1Why: getTxt('eval1'),
        eval2Choice: getVal('eval2'), eval2Why: getTxt('eval2'),
        eval3Choice: getVal('eval3'), eval3Why: getTxt('eval3'),
        eval4Choice: getVal('eval4'), eval4Why: getTxt('eval4')
      };

      // Debug: see exactly what we’re sending
      window.lastPayload = payload;
      console.log('Submitting payload:', payload);

      // Send as form-encoded (best for no-cors)
      const params = new URLSearchParams(payload);

      try {
        await fetch(SCRIPT_URL + '?' + PAGE_VERSION, {
          method: 'POST',
          mode: 'no-cors',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8' },
          body: params.toString()
        });
        if (msg) msg.textContent = '✅ Submitted!';
        // optional: clear the top three fields only
        document.getElementById('period').value = '';
        document.getElementById('firstName').value = '';
        document.getElementById('lastName').value = '';
      } catch (err) {
        console.error('Submit error:', err);
        if (msg) msg.textContent = 'Error submitting. Check console.';
      }
    });
  });
  </script>
</body>
</html>
